const express = require('express');
const bodyParser = require('body-parser');
const fetch = require('node-fetch');

const app = express();
const PORT = process.env.PORT || 3000;
const TELEGRAM_BOT_TOKEN = 7252679351:AAE_nqbKrzZhevl8FkJWtlxw6KDfiGHo2IA

app.use(bodyParser.json());

app.post('/send-wallet', async (req, res) => {
    const { telegramId, walletAddress } = req.body;
    const message = Your new wallet address: ${walletAddress};

    try {
        const response = await fetch(`https://api.telegram.org/bot${7252679351:AAE_nqbKrzZhevl8FkJWtlxw6KDfiGHo2IA}/sendMessage`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                chat_id: telegramId,
                text: message,
            }),
        });

        if (response.ok) {
            res.status(200).send('Wallet info sent to Telegram.');
        } else {
            res.status(500).send('Failed to send wallet info to Telegram.');
        }
    } catch (error) {
        console.error('Error sending message to Telegram:', error);
        res.status(500).send('Error sending message to Telegram.');
    }
});

app.post('/reward-crypto', (req, res) => {
    // Handle rewarding crypto to the user
    // This is a placeholder and should be replaced with actual implementation
    res.json({ success: true, message: 'Crypto rewarded to the user.' });
});

app.listen(PORT, () => {
    console.log(`Server is running on port ${PORT}`);
});